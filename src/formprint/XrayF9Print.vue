<template>
  <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏•‡πà‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π ‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏õ‡∏∏‡πà‡∏° Print + A4 -->
  <div class="print-root">
    <!-- ‡∏õ‡∏∏‡πà‡∏° Print (‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå) -->
    <div class="print-toolbar">
      <button class="btn-print" @click="handlePrint">
        üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å F9
      </button>
    </div>

    <!-- ‡πÅ‡∏ú‡πà‡∏ô A4 -->
    <div class="sheet-a4">
      <div class="sheet-inner">
        <!-- ‡∏´‡∏±‡∏ß‡∏ü‡∏≠‡∏£‡πå‡∏° -->
        <div class="header-main">
          <div class="title-main">
            ‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å F9 : ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Ñ‡∏∞‡∏ó‡πâ‡∏ß‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏≠‡∏¢‡πÅ‡∏ï‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Ñ‡∏∞‡∏ó‡πâ‡∏ß‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏≠‡∏Å‡∏ã‡πå
          </div>
          <div class="title-sub">
            ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà : {{ record.frequency }}
          </div>
        </div>

        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1 : ‡∏ï‡∏£‡∏ß‡∏à‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≥ -->
        <table class="f9-table">
          <thead>
            <tr>
              <th colspan="10" class="section-title">
                ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≥
              </th>
            </tr>
            <tr>
              <th class="col-no">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
              <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
              <th>‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
              <th>‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</th>
              <th>‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≥‡∏£‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢</th>
              <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
              <th>‡∏Ç‡∏ô‡∏≤‡∏î</th>
              <th>‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö</th>
              <th>‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
            </tr>
          </thead>
          <tbody>
            <tr
              v-for="(row, idx) in externalChecks"
              :key="'ext-' + idx"
            >
              <td class="col-no">{{ idx + 1 }}</td>
              <td>{{ row.equipmentNo }}</td>
              <td>{{ row.equipmentType }}</td>
              <td>{{ row.usageAge }}</td>
              <td>{{ row.checkDate }}</td>
              <td>{{ row.damageType }}</td>
              <td>{{ row.position }}</td>
              <td>{{ row.size }}</td>
              <td>{{ row.storageMethod }}</td>
              <td>{{ row.recorder }}</td>
            </tr>
            <!-- ‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏° (‡πÉ‡∏´‡πâ layout ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô PDF) -->
            <tr v-for="n in emptyExternalRows" :key="'ext-empty-' + n">
              <td class="col-no">&nbsp;</td>
              <td colspan="9">&nbsp;</td>
            </tr>
          </tbody>
        </table>

        <!-- ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
        <div class="table-gap"></div>

        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2 : ‡∏ï‡∏£‡∏ß‡∏à‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏≠‡∏Å‡∏ã‡πå -->
        <table class="f9-table">
          <thead>
            <tr>
              <th colspan="10" class="section-title">
                ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏≠‡∏Å‡∏ã‡πå‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏≤‡∏á‡∏£‡∏±‡∏á‡∏™‡∏µ/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
              </th>
            </tr>
            <tr>
              <th class="col-no">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
              <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
              <th>‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
              <th>‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</th>
              <th>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏û‡∏ö</th>
              <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
              <th>‡∏Ç‡∏ô‡∏≤‡∏î</th>
              <th>‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö</th>
              <th>‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
            </tr>
          </thead>
          <tbody>
            <tr
              v-for="(row, idx) in internalChecks"
              :key="'int-' + idx"
            >
              <td class="col-no">{{ idx + 1 }}</td>
              <td>{{ row.equipmentNo }}</td>
              <td>{{ row.equipmentType }}</td>
              <td>{{ row.usageAge }}</td>
              <td>{{ row.checkDate }}</td>
              <td>{{ row.internalFinding }}</td>
              <td>{{ row.position }}</td>
              <td>{{ row.size }}</td>
              <td>{{ row.storageMethod }}</td>
              <td>{{ row.recorder }}</td>
            </tr>
            <!-- ‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô PDF -->
            <tr v-for="n in emptyInternalRows" :key="'int-empty-' + n">
              <td class="col-no">&nbsp;</td>
              <td colspan="9">&nbsp;</td>
            </tr>
          </tbody>
        </table>

        <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á -->
        <div class="signature-block">
          <div class="sig-row">
            ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠.................................................................‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö
          </div>
          <div class="sig-row">
            (.................................................................)
          </div>
          <div class="sig-row">
            ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á.............................................................
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { useRoute } from 'vue-router'

const route = useRoute()

// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏±‡∏ß‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
const record = ref({
  frequency: '‡∏ó‡∏∏‡∏Å 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'
})

// ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å
const externalChecks = ref([])
// ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô
const internalChecks = ref([])

// ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏ö‡∏î‡∏π‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô PDF
const minExternalRows = 3
const minInternalRows = 3

const emptyExternalRows = computed(() =>
  Math.max(0, minExternalRows - externalChecks.value.length)
)

const emptyInternalRows = computed(() =>
  Math.max(0, minInternalRows - internalChecks.value.length)
)

function handlePrint () {
  window.print()
}

onMounted(async () => {
  const id = route.params.id

  // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å backend (‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ URL/field ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á)
  // const res = await fetch(`/api/f9/${id}`)
  // const data = await res.json()
  //
  // record.value = {
  //   frequency: data.frequency || '‡∏ó‡∏∏‡∏Å 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'
  // }
  //
  // externalChecks.value = data.externalChecks || []
  // internalChecks.value = data.internalChecks || []

  // *** ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á mock data ‡πÄ‡∏≠‡∏≤‡∏≠‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° API ‡∏à‡∏£‡∏¥‡∏á ***
  externalChecks.value = [
    {
      equipmentNo: '‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 001',
      equipmentType: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Ñ‡∏∞‡∏ó‡πâ‡∏ß‡∏á',
      usageAge: '> 3 ‡∏õ‡∏µ',
      checkDate: '4/3/65',
      damageType: '‡∏£‡∏≠‡∏¢‡∏´‡∏±‡∏Å',
      position: '‡∏ö‡πà‡∏≤‡∏Ç‡∏ß‡∏≤ ‡∏´‡∏ô‡πâ‡∏≤',
      size: '3√ó10 cm',
      storageMethod: '‡πÑ‡∏°‡πà‡πÅ‡∏Ç‡∏ß‡∏ô',
      recorder: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏±‡∏á‡∏™‡∏µ'
    }
  ]

  internalChecks.value = [
    {
      equipmentNo: '‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 001',
      equipmentType: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Ñ‡∏∞‡∏ó‡πâ‡∏ß‡∏á',
      usageAge: '> 5 ‡∏õ‡∏µ',
      checkDate: '4/3/65',
      internalFinding: '‡∏£‡∏≠‡∏¢‡∏£‡πâ‡∏≤‡∏ß‡∏¢‡∏≤‡∏ß',
      position: '‡∏≠‡∏Å‡∏´‡∏ô‡πâ‡∏≤',
      size: '3√ó10 cm',
      storageMethod: '‡∏ß‡∏≤‡∏á‡∏£‡∏≤‡∏ö',
      recorder: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏±‡∏á‡∏™‡∏µ'
    }
  ]
})
</script>

<style scoped>
@import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap');

* {
  font-family: 'TH Sarabun New', 'Sarabun', Tahoma, sans-serif !important;
}

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ô‡∏≠‡∏Å */
.print-root {
  background: #111827;
  min-height: 100vh;
  padding: 16px 0;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* ‡∏õ‡∏∏‡πà‡∏° print */
.print-toolbar {
  margin-bottom: 18px;
}

.btn-print {
  padding: 6px 18px;
  background: #ffffff;
  border-radius: 999px;
  border: 1px solid #4b5563;
  cursor: pointer;
  font-size: 16px;
}

/* A4 */
.sheet-a4 {
  width: 210mm;
  min-height: 297mm;
  background: #ffffff;
  box-shadow: 0 0 4mm rgba(0, 0, 0, 0.35);
  display: flex;
  justify-content: center;
}

.sheet-inner {
  width: 185mm;
  padding: 18mm 0 14mm;
  font-size: 14pt;
}

/* Header */
.header-main {
  text-align: center;
  margin-bottom: 8mm;
}

.title-main {
  font-weight: 700;
  margin-bottom: 2mm;
  font-size: 18pt;
}

.title-sub {
  margin-bottom: 2mm;
  font-size: 15pt;
}

/* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
.f9-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
  font-size: 13pt;
}

.f9-table th,
.f9-table td {
  border: 0.4pt solid #000;
  padding: 1.5mm 1mm;
  vertical-align: middle;
  text-align: center;
}

.section-title {
  font-weight: 700;
  text-align: left;
  padding-left: 3mm;
}

.col-no {
  width: 12mm;
}

/* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
.table-gap {
  height: 8mm;
}

/* ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô */
.signature-block {
  margin-top: 10mm;
  font-size: 14pt;
}

.sig-row {
  margin-bottom: 3mm;
  text-align: right;
  padding-right: 20mm;
}

/* ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå */
@page {
  size: A4 portrait;
  margin: 10mm;
}

@media print {
  .print-toolbar {
    display: none;
  }

  .print-root {
    background: #ffffff;
    padding: 0;
  }

  .sheet-a4 {
    box-shadow: none;
    width: auto;
    min-height: auto;
  }
}
</style>
