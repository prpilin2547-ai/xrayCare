<template>
  <div class="print-root">

    <!-- ‡πÅ‡∏ñ‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏õ‡∏£‡∏¥‡πâ‡∏ô) -->
    <div class="print-toolbar">
      <button class="btn-print" @click="handlePrint">
        üñ® Print
      </button>
    </div>

    <!-- A4 ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ -->
    <div class="sheet-a4">
      <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå PDF ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ -->

      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ (‡∏ï‡∏±‡∏ß‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏à‡∏£‡∏¥‡∏á) -->
      <div class="form-area">
        <!-- ‡πÅ‡∏ñ‡∏ö‡∏´‡∏±‡∏ß‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å) -->
        <div class="form-main-title">
          ‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏±‡∏ß‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö PDF -->
        <div class="form-meta">
          <div class="meta-row">
            <span class="meta-strong">
              {{ record.formCode }}
            </span>
          </div>
          <div class="meta-row">
            <span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà : </span>
            <span>{{ record.frequency }}</span>
          </div>
          <div class="meta-row">
            <span>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå :</span>
            <span class="underline underline-long">
              {{ record.machineName }}
            </span>
            <span class="meta-label">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô :</span>
            <span class="underline underline-short">
              {{ record.monthName }} {{ record.yearBe }}
            </span>
          </div>
        </div>

        <!-- ‡πÅ‡∏ñ‡∏ß "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà / ‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö / ‡∏ä‡πà‡∏≠‡∏á‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠" ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô -->
        <table class="qc-meta-table">
          <tr>
            <td class="qc-meta-date">
              ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà :
              <span class="underline underline-small">
                {{ record.printDate }}
              </span>
            </td>
            <td class="qc-meta-tester">
              ‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö :
              <span class="underline underline-wide">
                {{ record.testerName }}
              </span>
            </td>
            <td class="qc-meta-sign">
              ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠/‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö :
              <span class="underline underline-wide"></span>
            </td>
          </tr>
        </table>

        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡πÄ‡∏•‡πà‡∏°) -->
        <div class="table-wrapper">
          <table class="qc-table">
            <thead>
              <!-- ‡πÅ‡∏ñ‡∏ß‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏∏‡πà‡∏° -->
              <tr>
                <th class="col-item" rowspan="2">
                  ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
                </th>
                <th class="col-days-group" colspan="31">
                  ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Pass (‚úì) / Fail (‚úó) ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                </th>
              </tr>
              <!-- ‡πÅ‡∏ñ‡∏ß‡πÄ‡∏•‡∏Ç‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1‚Äì31 -->
              <tr>
                <th
                  v-for="d in 31"
                  :key="'head-day-' + d"
                  class="col-day"
                >
                  {{ d }}
                </th>
              </tr>
            </thead>

            <tbody>
              <!-- ‡πÅ‡∏ñ‡∏ß‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á (‡∏°‡∏µ‡πÅ‡∏Ñ‡πà 4 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤) -->
              <tr v-for="(row, idx) in record.rows" :key="'row-' + idx">
                <td class="col-item">
                  {{ row.name }}
                </td>
                <td
                  v-for="d in 31"
                  :key="'row-' + idx + '-day-' + d"
                  class="col-day"
                >
                  <span v-if="row.resultsByDay[d] === 'pass'">‚úì</span>
                  <span v-else-if="row.resultsByDay[d] === 'fail'">‚úó</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from "vue";
import { useRoute } from "vue-router";

/**
 * ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ render ‡πÄ‡∏õ‡πá‡∏ô A4 ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πâ window.print()
 * ‡πÉ‡∏´‡πâ main app ‡πÄ‡∏õ‡∏¥‡∏î route ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ (‡πÑ‡∏°‡πà‡∏°‡∏µ side menu)
 */

const route = useRoute();

// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏£‡∏¥‡∏á (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á mock ‡∏ï‡∏≤‡∏° JSON ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ)
const record = ref({
  id: route.params.id || "F1-001",
  formCode: "‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å F1 : ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå",
  frequency: "‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô",
  machineName: "X-Ray Room 1 (Shimadzu XXX)",
  monthName: "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô",
  yearBe: 2568,
  testerName: "‡∏ô‡∏û. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö",
  printDate: "", // ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÉ‡∏´‡πâ‡∏°‡∏≤ bind ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
  rows: [
    {
      name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü : ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏ß‡∏° ‡πÑ‡∏°‡πà‡∏Ñ‡∏î‡∏á‡∏≠ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡πÑ‡∏´‡∏°‡πâ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏±‡∏ö‡∏™‡∏≤‡∏¢",
      resultsByDay: { 1: "pass", 2: "pass" }
    },
    {
      name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏£‡∏Å : ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á",
      resultsByDay: { 1: "pass" }
    },
    {
      name: "‡πÄ‡∏ï‡∏µ‡∏¢‡∏á ‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏≠‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏Å‡∏Å‡∏µ‡πâ : ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö",
      resultsByDay: { 1: "pass" }
    },
    {
      name: "X-ray tube warm-up : ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï",
      resultsByDay: { 1: "pass" }
    }
  ]
});

function handlePrint() {
  window.print();
}

onMounted(() => {
  // const id = route.params.id;
  // fetch(`/api/xray-check/${id}`) ...
});
</script>

<style scoped>
/* ----------------- ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ----------------- */
.print-root {
  background: #e5e7eb;
  min-height: 100vh;
  padding: 16px 0;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* ‡πÅ‡∏ñ‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
.print-toolbar {
  margin-bottom: 8px;
}

.btn-print {
  padding: 6px 16px;
  border-radius: 999px;
  border: 1px solid #4b5563;
  background: white;
  font-size: 0.9rem;
  cursor: pointer;
}

/* ----------------- A4 sheet ----------------- */
.sheet-a4 {
  width: 210mm;
  min-height: 297mm;
  background: white;
  box-shadow: 0 0 4mm rgba(0, 0, 0, 0.15);
  display: flex;
  font-family: "TH Sarabun New", "Tahoma", sans-serif;
  font-size: 11pt;
}

/* ----------------- form area ----------------- */
.form-area {
  flex: 1;
  padding: 18mm 10mm 10mm 10mm;
  display: flex;
  flex-direction: column;
}

/* ‡πÅ‡∏ñ‡∏ö‡∏´‡∏±‡∏ß‡∏™‡∏µ‡πÄ‡∏ó‡∏≤ "‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å" ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
.form-main-title {
  background: #e5e5e5;
  text-align: center;
  padding: 3mm 0;
  font-weight: 700;
  margin-bottom: 6mm;
}

/* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏±‡∏ß‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
.form-meta {
  font-size: 11pt;
  margin-bottom: 4mm;
}

.meta-row {
  margin-bottom: 1.5mm;
}

.meta-strong {
  font-weight: 700;
}

.meta-label {
  margin-left: 8mm;
}

/* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏µ‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö */
.underline {
  border-bottom: 0.4pt solid #000;
  min-height: 5mm;
  padding: 0 2mm;
  display: inline-block;
}

.underline-short {
  min-width: 35mm;
}

.underline-long {
  min-width: 70mm;
}

.underline-small {
  min-width: 22mm;
}

.underline-wide {
  min-width: 60mm;
}

/* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏±‡∏ß "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà / ‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö / ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠" */
.qc-meta-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 3mm;
  font-size: 10pt;
}

.qc-meta-table td {
  border: 0.4pt solid #000;
  padding: 1mm 2mm;
}

.qc-meta-date {
  width: 30%;
}

.qc-meta-tester {
  width: 40%;
}

.qc-meta-sign {
  width: 30%;
}

/* ----------------- Table ----------------- */
.table-wrapper {
  flex: 1;
}

.qc-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
  font-size: 9pt;
}

.qc-table th,
.qc-table td {
  border: 0.4pt solid #000;
  padding: 1mm 1mm;
  vertical-align: middle;
  text-align: center;
}

/* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå */
.col-item {
  width: 55mm;
  text-align: left;
}

.col-days-group {
  text-align: center;
}

.col-day {
  width: 6mm;
}

/* ----------------- print CSS ----------------- */
@page {
  size: A4 portrait;
  margin: 10mm;
}

@media print {
  .print-root {
    padding: 0;
    background: white;
  }

  .sheet-a4 {
    box-shadow: none;
    width: auto;
    min-height: auto;
  }

  .print-toolbar {
    display: none;
  }
}
</style>
