<template>
  <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π ‡πÑ‡∏°‡πà‡∏°‡∏µ MainLayout -->
  <div class="print-root">

    <!-- ‡πÅ‡∏ñ‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏õ‡∏£‡∏¥‡πâ‡∏ô) -->
    <div class="print-toolbar">
      <button class="btn-print" @click="handlePrint">
        üñ® Print
      </button>
    </div>

    <!-- A4 ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ -->
    <div class="sheet-a4">
      <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå PDF ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ -->

      <!-- ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ó‡∏≤‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ -->
      <div class="left-strip">
        <div class="left-strip-inner">
          <div class="vertical-text main-title">
            ‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          </div>
          <div class="vertical-text sub-title">
            ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå
          </div>
          <div class="page-number">
            60
          </div>
        </div>
      </div>

      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ (‡∏ï‡∏±‡∏ß‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏à‡∏£‡∏¥‡∏á) -->
      <div class="form-area">

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å) -->
        <div class="header-block">
          <div class="header-row">
            <span class="label">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå :</span>
            <span class="value underline">{{ record.machineName }}</span>
          </div>
          <div class="header-row">
            <span class="label">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô :</span>
            <span class="value underline">{{ record.month }} {{ record.year }}</span>

            <span class="label center-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà :</span>
            <span class="value underline small">
              {{ record.day }}
            </span>
          </div>
          <div class="header-row">
            <span class="label">‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö :</span>
            <span class="value underline">{{ record.testerName }}</span>

            <span class="label center-label">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö :</span>
            <span class="value underline small">
              {{ record.result }}
            </span>
          </div>
        </div>

        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (‡πÇ‡∏Ñ‡∏£‡∏á‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏£‡∏π‡∏õ) -->
        <div class="table-wrapper">
          <table class="qc-table">
            <thead>
              <tr>
                <th class="col-no" rowspan="2">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                <th class="col-item" rowspan="2">
                  ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö / ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
                </th>
                <th class="col-result" rowspan="2">
                  ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö<br />
                  Pass (‚úì) / Fail (‚úó)<br />
                  ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                </th>
                <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1-31 -->
                <th
                  v-for="d in 31"
                  :key="d"
                  class="col-day"
                >
                  {{ d }}
                </th>
              </tr>
            </thead>

            <tbody>
              <!-- ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ) -->
              <tr v-for="(row, idx) in rows" :key="idx">
                <td class="col-no">{{ idx + 1 }}</td>
                <td class="col-item">
                  {{ row.name }}
                </td>
                <td class="col-result">
                  <!-- ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏≤‡∏° record.day ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á ‚úì ‡∏´‡∏£‡∏∑‡∏≠ ‚úó -->
                  <span v-if="row.days[record.day] === 'pass'">‚úì</span>
                  <span v-else-if="row.days[record.day] === 'fail'">‚úó</span>
                </td>

                <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1-31 -->
                <td
                  v-for="d in 31"
                  :key="d"
                  class="col-day"
                >
                  <span v-if="row.days[d] === 'pass'">‚úì</span>
                  <span v-else-if="row.days[d] === 'fail'">‚úó</span>
                </td>
              </tr>

              <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡πÅ‡∏ñ‡∏ß‡πÄ‡∏õ‡∏•‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° -->
              <tr v-for="n in blankRowCount" :key="'blank-' + n">
                <td class="col-no">&nbsp;</td>
                <td class="col-item">&nbsp;</td>
                <td class="col-result">&nbsp;</td>
                <td
                  v-for="d in 31"
                  :key="'b-' + n + '-' + d"
                  class="col-day"
                >
                  &nbsp;
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from "vue";
import { useRoute } from "vue-router";

/**
 * ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ render ‡πÄ‡∏õ‡πá‡∏ô A4 ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πâ window.print()
 * ‡πÉ‡∏´‡πâ main app ‡πÄ‡∏õ‡∏¥‡∏î route ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ (‡πÑ‡∏°‡πà‡∏°‡∏µ side menu)
 */

const route = useRoute();

// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏£‡∏¥‡∏á (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á mock)
// ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£ fetch ‡∏à‡∏≤‡∏Å API ‡∏´‡∏£‡∏∑‡∏≠ Pinia store ‡πÑ‡∏î‡πâ
const record = ref({
  id: route.params.id || "F1-001",
  machineName: "X-Ray Room 1 (Brand/Model)",
  month: "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô",
  year: 2568,
  day: 26,
  testerName: "‡∏ô‡∏û. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö",
  result: "Pass"
});

// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö (‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡πÄ‡∏•‡πà‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏≠‡∏≤‡πÄ‡∏≠‡∏á)
const rows = ref([
  {
    name: "1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏†‡∏≤‡∏û‡∏£‡∏±‡∏á‡∏™‡∏µ",
    days: { 26: "pass" }
  },
  {
    name: "2. ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏£‡∏±‡∏á‡∏™‡∏µ",
    days: { 26: "pass" }
  },
  {
    name: "3. ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏£‡∏±‡∏á‡∏™‡∏µ",
    days: { 26: "pass" }
  }
]);

// ‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏¢‡∏≤‡∏ß‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏≠‡∏≤ 12 ‡πÅ‡∏ñ‡∏ß)
const targetRowCount = 12;
const blankRowCount = computed(() =>
  Math.max(0, targetRowCount - rows.value.length)
);

function handlePrint() {
  // ‡πÄ‡∏õ‡∏¥‡∏î dialog ‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏Ç‡∏≠‡∏á browser (Chrome/Google)
  window.print();
}

// ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API ‡∏à‡∏£‡∏¥‡∏á ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ onMounted
onMounted(() => {
  // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô id ‡∏à‡∏≤‡∏Å route:
  // const id = route.params.id;
  // ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ fetch(`/api/xray-check/${id}`) ...
});
</script>

<style scoped>
/* ----------------- ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ----------------- */
.print-root {
  background: #e5e7eb;
  min-height: 100vh;
  padding: 16px 0;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* ‡πÅ‡∏ñ‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
.print-toolbar {
  margin-bottom: 8px;
}

.btn-print {
  padding: 6px 16px;
  border-radius: 999px;
  border: 1px solid #4b5563;
  background: white;
  font-size: 0.9rem;
  cursor: pointer;
}

/* ----------------- A4 sheet ----------------- */
.sheet-a4 {
  width: 210mm;
  min-height: 297mm;
  background: white;
  box-shadow: 0 0 4mm rgba(0, 0, 0, 0.15);
  display: flex;
  font-family: "Th Sarabun New", "Tahoma", sans-serif;
  font-size: 11pt;
}

/* ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ó‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
.left-strip {
  width: 28mm;
  background: #e5e5e5;
  position: relative;
  border-right: 0.4pt solid #999;
}

.left-strip-inner {
  position: absolute;
  inset: 16mm 6mm 16mm 6mm;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
}

.vertical-text {
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  text-align: center;
}

.main-title {
  font-weight: 700;
  font-size: 14pt;
}

.sub-title {
  font-size: 10pt;
}

.page-number {
  width: 18mm;
  height: 18mm;
  border-radius: 999px;
  border: 0.6pt solid #555;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10pt;
}

/* ----------------- form area ----------------- */
.form-area {
  flex: 1;
  padding: 18mm 10mm 10mm 10mm;
  display: flex;
  flex-direction: column;
}

/* header ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á, ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö */
.header-block {
  margin-bottom: 8mm;
  font-size: 11pt;
}

.header-row {
  display: flex;
  align-items: baseline;
  margin-bottom: 2mm;
}

.header-row .label {
  min-width: 30mm;
}

.header-row .center-label {
  margin-left: 10mm;
  min-width: 24mm;
}

.header-row .value {
  flex-grow: 1;
}

.header-row .value.small {
  min-width: 24mm;
  flex: 0 0 auto;
}

.underline {
  border-bottom: 0.4pt solid #000;
  min-height: 5mm;
  padding: 0 2mm;
}

/* ----------------- Table ----------------- */
.table-wrapper {
  flex: 1;
}

.qc-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
  font-size: 9pt;
}

.qc-table th,
.qc-table td {
  border: 0.4pt solid #000;
  padding: 1mm 1mm;
  vertical-align: middle;
  text-align: center;
}

/* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå */
.col-no {
  width: 6mm;
}

.col-item {
  width: 55mm;
  text-align: left;
}

.col-result {
  width: 30mm;
}

.col-day {
  width: 6mm;
}

/* ----------------- print CSS ----------------- */
@page {
  size: A4 portrait;
  margin: 10mm;
}

@media print {
  .print-root {
    padding: 0;
    background: white;
  }

  .sheet-a4 {
    box-shadow: none;
    width: auto;
    min-height: auto;
  }

  .print-toolbar {
    display: none;
  }
}
</style>
